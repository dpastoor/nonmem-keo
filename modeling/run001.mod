$PROB RUN# ecomp1_pkpd EFFECT COMP POPULATION PK-PD MODEL 1
$INPUT  ID TIME CMT DV AMT TYPE
;TYPE 0 = PK, TYPE 1=PD
;CMT 1=GUT, 2=CENTRAL, 3=EFFECT
;DV =PK & PD ORDERED BY ID, TIME
$DATA ../data/dat1.csv IGNORE=@
$SUBROUTINE ADVAN3 TRANS1

$PK
 CL=THETA(1)*EXP(ETA(1))
 V=THETA(2)
 KE0=THETA(3)

 K=CL/V
 K12=K*0.0001 ;NEGLIGIBLE MASS TRANSFER
 K21=KE0
 S1=V
 S2=V*K12/K21  ;AS SS CE = CP

$ERROR
 CE=A(2)/S2
 CP=A(1)/V
 EMAX=THETA(4)
 EC50=THETA(5)
  CONC=F
 EFF= EMAX*F/(EC50+F) + ERR(2)

Y=CONC*(1-TYPE) + EFF*TYPE
SID=IREP
TYP2=TYPE
IPRED=Y

$THETA
(0, 0.1)     ;CL
(0, 1)     ;V

(0,0.1)     ;KE0
(0,100)     ;EMAX
(0,1)     ;EC50

$OMEGA 0 FIX
$SIGMA 0.01 1
;$SIMULATION (6546) ONLY SUB=20
$SIM ONLYSIM (123456)
;$COV
$TABLE NOPRINT FILE=all001 ONEHEADER
ID TIME TYPE CMT CL V KE0 CE CP CONC EFF
